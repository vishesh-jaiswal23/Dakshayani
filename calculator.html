<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Solar Savings Calculator | Dakshayani Enterprises</title>
    <meta name="description" content="Calculate your potential savings, required system size, and investment for rooftop solar in Jharkhand."/>

    <link rel="icon" href="images/favicon.ico" />
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer"/>

    <style>
        .calculator-hero {
            background: linear-gradient(135deg, var(--base-900), var(--base-700));
            color: white;
            text-align: center;
            padding: 4rem 1rem;
        }
        .calculator-panel {
            background: var(--surface);
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        .form-group {
            margin-bottom: 1.5rem;
        }
        .form-group label {
            display: block;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: var(--base-700);
        }
        .form-group input, .form-group select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--base-300);
            border-radius: 0.5rem;
            font-size: 1rem;
            transition: border-color 0.2s ease;
        }
        .form-group input:focus, .form-group select:focus {
            border-color: var(--primary-500);
            outline: none;
            box-shadow: 0 0 0 2px rgba(251, 191, 36, 0.5);
        }
        .result-box {
            text-align: center;
            padding: 2rem;
            border-radius: 1rem;
            background: var(--primary-50);
            margin-top: 2rem;
            border: 2px solid var(--primary-500);
        }
        .result-value {
            font-size: 2.5rem;
            font-weight: 900;
            color: var(--base-900);
            margin-bottom: 0.5rem;
        }
        .result-label {
            color: var(--base-700);
            font-weight: 600;
        }

        /* Message Box Styling */
        .message-box {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            max-width: 300px;
            text-align: center;
            border: 2px solid var(--primary-500);
            display: none; /* Hidden by default */
        }
        .message-box button {
            margin-top: 15px;
            width: 100%;
        }
    </style>
</head>
<body>

    <!-- Error/Message Box -->
    <div id="message-modal" class="message-box">
        <p id="message-text" style="color: var(--base-900); font-weight: 600;"></p>
        <button class="btn btn-primary" onclick="document.getElementById('message-modal').style.display = 'none';">OK</button>
    </div>

    <!-- HEADER injected via script.js -->
    <header class="site-header"></header>

    <main>
        <!-- Page Header/Hero -->
        <section class="calculator-hero">
            <div class="container">
                <h1 class="title" style="color:var(--surface);">Solar Savings Calculator</h1>
                <p class="sub" style="color:rgba(255,255,255,.9); max-width: 800px; margin: 0 auto;">Estimate your optimal solar system size, installation cost, and potential savings based on Jharkhand's solar generation average.</p>
            </div>
        </section>

        <!-- Calculator Section -->
        <section class="section">
            <div class="container grid" style="grid-template-columns: 2fr 1fr; gap: 3rem;">
                <!-- Input Form -->
                <div class="calculator-panel">
                    <h2 class="title" style="margin-top: 0;">Enter Your Details</h2>
                    <form id="solar-calculator-form">
                        <div class="form-group">
                            <label for="monthly-consumption">Monthly Electricity Consumption (Units)</label>
                            <input type="number" id="monthly-consumption" placeholder="e.g., 400" required />
                            <p style="font-size: 0.85rem; color: var(--base-500); margin-top: 0.25rem;">
                                If you only know your bill amount: Units $\approx$ Bill / Rate. (e.g., ₹2500 bill / ₹6.5 rate $\approx$ 385 units)
                            </p>
                        </div>
                        <div class="form-group">
                            <label for="unit-rate">Average Unit Rate (INR/Unit)</label>
                            <input type="number" step="0.01" id="unit-rate" placeholder="e.g., 6.50" required />
                            <p style="font-size: 0.85rem; color: var(--base-500); margin-top: 0.25rem;">
                                Used to calculate annual savings from electricity offset.
                            </p>
                        </div>
                        <div class="form-group">
                            <label for="system-type">System Type</label>
                            <select id="system-type">
                                <option value="residential">Residential (PM Surya Ghar)</option>
                                <option value="commercial">Commercial / Industrial</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 1rem;">Calculate My Solar Potential</button>
                    </form>
                </div>

                <!-- Results Display -->
                <div id="results-display" class="calculator-panel">
                    <h2 class="title" style="margin-top: 0;">Your Solar Estimate</h2>
                    <div id="loading" style="text-align: center; padding: 2rem; display: none;">
                        <i class="fa-solid fa-spinner fa-spin fa-2x" style="color: var(--primary-500);"></i>
                        <p>Calculating...</p>
                    </div>
                    <div id="initial-message">
                        <p class="copy" style="text-align: center; color: var(--base-500);">Fill out the form to see your recommended system size, estimated cost, and annual savings.</p>
                    </div>
                    
                    <div id="calculated-results" style="display: none;">
                        <div class="result-box">
                            <div class="result-label">Recommended System Size</div>
                            <div class="result-value" id="system-size-output">0 kWp</div>
                        </div>
                        
                        <div class="grid cols-2" style="margin-top: 1.5rem;">
                            <div class="result-box" style="padding: 1rem 0.5rem; background: var(--surface); border: 1px solid var(--base-200);">
                                <div class="result-label" style="font-size: 0.9rem;">Est. Annual Savings</div>
                                <div class="result-value" id="annual-savings-output" style="font-size: 1.5rem;">₹0</div>
                            </div>
                            <div class="result-box" style="padding: 1rem 0.5rem; background: var(--surface); border: 1px solid var(--base-200);">
                                <div class="result-label" style="font-size: 0.9rem;">Est. Investment (Net)</div>
                                <div class="result-value" id="net-cost-output" style="font-size: 1.5rem;">₹0</div>
                            </div>
                        </div>
                        
                        <a href="contact.html" class="btn btn-primary" style="width: 100%; margin-top: 1.5rem;">Get Accurate Quote</a>
                    </div>
                </div>
            </div>
        </section>

        <!-- Disclaimer Section -->
        <section class="section" style="padding-top: 0; padding-bottom: 3rem;">
            <div class="container" style="max-width: 900px;">
                <h3 class="title" style="font-size: 1.5rem; margin-top: 0;">Important Disclaimer:</h3>
                <p class="copy" style="font-size: 0.95rem; color: var(--base-500);">
                    **Production Rate:** This calculation uses a local average solar generation rate of **5 units/day per kW** installed, which is typical for Jharkhand. Actual generation depends on site-specific factors like roof orientation, shading, and weather.
                    <br>
                    **Costs & Subsidy:** Investment costs and subsidies (especially for PM Surya Ghar) are indicative and based on current government guidelines. Final costs and eligibility must be confirmed after a site survey.
                </p>
            </div>
        </section>
    </main>

    <!-- FOOTER injected via script.js -->
    <footer class="site-footer"></footer>

    <!-- Calculator Logic Script -->
    <script>
        // Function to display custom message box instead of alert()
        function showMessage(text) {
            document.getElementById('message-text').textContent = text;
            document.getElementById('message-modal').style.display = 'block';
        }

        document.getElementById('solar-calculator-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const consumption = parseFloat(document.getElementById('monthly-consumption').value);
            const rate = parseFloat(document.getElementById('unit-rate').value);
            const type = document.getElementById('system-type').value;

            if (isNaN(consumption) || consumption <= 0) {
                showMessage('Please enter a valid monthly consumption in units (kWh).');
                return;
            }
            if (isNaN(rate) || rate <= 0) {
                showMessage('Please enter a valid average unit rate (e.g., 6.50).');
                return;
            }

            const resultsContainer = document.getElementById('calculated-results');
            const initialMessage = document.getElementById('initial-message');
            const loading = document.getElementById('loading');

            initialMessage.style.display = 'none';
            resultsContainer.style.display = 'none';
            loading.style.display = 'block';

            // --- Calculation Logic ---
            
            // 1. Calculate required system size (kWp)
            // USER REQUESTED: 1 kWp produces 5 units/day on average -> 150 units/month (5 * 30)
            const unitsPerKwPerMonth = 150; 
            let requiredSize = consumption / unitsPerKwPerMonth;

            // Round up to the nearest practical size (e.g., 0.5 kW increments for display)
            requiredSize = Math.ceil(requiredSize * 2) / 2;

            // Cap residential size for calculation/subsidy purposes (max 10kW is common, max subsidy at 3kW)
            if (type === 'residential' && requiredSize > 10) requiredSize = 10;
            if (requiredSize < 1) requiredSize = 1; // Minimum practical size

            // 2. Calculate Gross Cost (Approximate benchmark for Jharkhand)
            // Avg cost per kWp: ~₹50,000 for simplicity.
            const costPerKw = 50000;
            let grossCost = requiredSize * costPerKw;
            
            // 3. Calculate Subsidy (as per PM Surya Ghar up to 3kW)
            let subsidy = 0;
            if (type === 'residential') {
                if (requiredSize <= 2) {
                    // ₹30,000 per kW (up to 2kW)
                    subsidy = requiredSize * 30000;
                } else if (requiredSize > 2 && requiredSize <= 3) {
                    // ₹60,000 for first 2kW, plus ₹18,000 for 3rd kW (Total ₹78,000)
                    subsidy = 78000;
                } else {
                    // Maximum subsidy is capped at ₹78,000 for systems > 3kW
                    subsidy = 78000;
                }
            }

            // 4. Calculate Net Cost (Investment)
            let netCost = grossCost - subsidy;
            if (netCost < 0) netCost = 0; 

            // 5. Calculate Annual Savings (Monthly consumption * Rate * 12 months)
            const annualSavings = consumption * rate * 12; 

            // --- Display Results with a small delay for the 'loading' effect ---
            setTimeout(() => {
                document.getElementById('system-size-output').textContent = requiredSize.toFixed(1) + ' kWp';
                document.getElementById('annual-savings-output').textContent = '₹' + annualSavings.toLocaleString('en-IN', { maximumFractionDigits: 0 });
                document.getElementById('net-cost-output').textContent = '₹' + netCost.toLocaleString('en-IN', { maximumFractionDigits: 0 });
                
                loading.style.display = 'none';
                resultsContainer.style.display = 'block';
            }, 800);
        });
    </script>
    <!-- Partials loader script -->
    <script src="script.js" defer></script>
</body>
</html>
